y = x%*%beta.true + sigma.star*rnorm(180)
dim(x)
x%*%beta.true
x = cbind(1, d[,c(1:4)])
class
class(x)
head(d)
head(x)
x%*%beta.true
x = as.matrix(cbind(1, d[,c(1:4)]))
head(x)
x = as.matrix(cbind(1, d[,c(1:4)]))
x%*%beta.true
dim(x)
t(x)%*%beta.true
x = as.matrix(cbind(1, d[,c(1:4)]))
sim(x)
dim(x)
beta.true
beta.true = c(4,2,3,5,10)
x %*% beta.true
y = x %*% beta.true + sigma.star*rnorm(180)
lm(y~x)
X = as.matrix(cbind(1, d[,c(1:4)]))
Y = x %*% beta.true + sigma.star*rnorm(180)
lm.fit(x=X, y=Y)$coefficient
lm.fit(x=X, y=Y)
?lm.fit
?lm
X = cbind(1, d[,c(1:4)])
X %*% beta.true
as.matix(X) %*% beta.true
as.matrix(X) %*% beta.true
m1_no = lm(Y~., X)
m1_no$coefficients
lm.fit(x=X, y=Y)$coefficient
lm.fit(x=as.matrix(X), y=Y)$coefficient
m1 = lm(Y~.,X)
m1$coefficients
m1_no = lm(Y~-y_pre_day, X)
m1_no$coefficients
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
X_plot = cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = Y)
site_1 = c(rep(c(0,0,1),60))
site_2 = c(rep(c(0,1,0),60))
ft = c(rep(c(0,0,0,1,1,1),30))
y_pre_day = rpois(180, 10)
day = c(rep(1:30, each = 6))
d = data.frame(cbind(site_1,site_2,ft, y_pre_day, day))
beta.true = c(4,2,3,5,10)
sigma.star = 2
X = cbind(1, d[,c(1:4)])
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(180)
m1 = lm(Y~.,X)
m1$coefficients
#lm.fit(x=as.matrix(X), y=Y)$coefficient
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
X_plot = cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = Y)
head(X_plot)
X_plot = cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = as.vector(Y))
head(X_plot)
library(ggplot2)
ggplot(X_plot, aes(y = Y, x=day, group = interaction(site,ft)))+
geom_point() + geom_line()
y = Y
class(y)
y = as.vector(Y)
class(y)
X_plot = cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y)
ggplot(X_plot, aes(y = Y, x=day, group = interaction(site,ft)))+
geom_point() + geom_line()
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y))
library(ggplot2)
ggplot(X_plot, aes(y = Y, x=day, group = interaction(site,ft)))+
geom_point() + geom_line()
ggplot(X_plot, aes(y = Y, x=day,
group = interaction(site,ft),
color = interaction(site,ft)))+
geom_point() + geom_line()
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values))
X_plot$comb = paste(X_plot$site, X_plot$ft, "_")
str(X_plot)
X_plot$comb = paste(X_plot$site, "_", X_plot$ft)
site_1 = c(rep(c(0,0,1),60))
site_2 = c(rep(c(0,1,0),60))
ft = c(rep(c(0,0,0,1,1,1),30))
y_pre_day = rpois(180, 10)
day = c(rep(1:30, each = 6))
d = data.frame(cbind(site_1,site_2,ft, y_pre_day, day))
beta.true = c(4,2,3,5,10)
sigma.star = 2
X = cbind(1, d[,c(1:4)])
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(180)
m1 = lm(Y~.,X)
m1$coefficients
lm.fit(x=as.matrix(X), y=Y)$coefficient
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
y = as.vector(Y)
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values))
library(ggplot2)
X_plot$site_type = paste(X_plot$site, "_", X_plot$ft)
ggplot(X_plot, aes(y = Y, x=day,
group = site_type,
color = site_type))+
geom_point() + geom_line() + facets(site_type~.)
site_1 = c(rep(c(0,0,1),60))
site_2 = c(rep(c(0,1,0),60))
ft = c(rep(c(0,0,0,1,1,1),30))
y_pre_day = rpois(180, 10)
day = c(rep(1:30, each = 6))
d = data.frame(cbind(site_1,site_2,ft, y_pre_day, day))
beta.true = c(4,2,3,5,10)
sigma.star = 2
X = cbind(1, d[,c(1:4)])
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(180)
m1 = lm(Y~.,X)
m1$coefficients
lm.fit(x=as.matrix(X), y=Y)$coefficient
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
y = as.vector(Y)
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values))
library(ggplot2)
X_plot$site_type = paste(X_plot$site, "_", X_plot$ft)
ggplot(X_plot, aes(y = Y, x=day,
group = site_type,
color = site_type))+
geom_point() + geom_line() + facets_grid(site_type~.)
ggplot(X_plot, aes(y = Y, x=day,
group = site_type,
color = site_type))+
geom_point() + geom_line() + facet_grid(site_type~.)
?gather
library(tidyr)
?gather
X_plot_long = gather(X_plot, "Y","fit.Y", key = "record", value = "value")
str(X_plot)
X_plot_long = gather(X_plot, "Y","fit.Y", key = "record",
value = "value")
site_1 = c(rep(c(0,0,1),60))
site_2 = c(rep(c(0,1,0),60))
ft = c(rep(c(0,0,0,1,1,1),30))
y_pre_day = rpois(180, 10)
day = c(rep(1:30, each = 6))
d = data.frame(cbind(site_1,site_2,ft, y_pre_day, day))
beta.true = c(4,2,3,5,10)
sigma.star = 2
X = cbind(1, d[,c(1:4)])
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(180)
m1 = lm(Y~.,X)
m1$coefficients
lm.fit(x=as.matrix(X), y=Y)$coefficient
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
y = as.vector(Y)
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values))
library(ggplot2)
library(tidyr)
X_plot$site_type = paste(X_plot$site, "_", X_plot$ft)
X_plot_long = gather(X_plot, "Y","fit.Y", key = "record",
value = "value")
ggplot(X_plot, aes(y = Y, x=day,
group = site_type,
color = site_type))+
geom_point() + geom_line() + facet_grid(site_type~.)
X_plot_long
class(X_plot)
str(X_plot)
X_plot_long = gather(X_plot, "Y","fit.Y", key = "record",
value = "value")
X_plot_long = gather(X_plot, "Y","fit.Y", key = "record",
value = "value")
names(id.var)
names(X_plot)
library(reshape2)
X_plot_long = melt(X_plot, id.vars=c(1:4,7))
dim(X_plot_long)
X_plot_long = melt(X_plot, id.vars=c(1:4,7))
ggplot(X_plot_long, aes(y = Y, x=day,
group = site_type,
color = site_type))+
geom_point() + geom_line() + facet_grid(site_type~.)
names(X_plot_long)
ggplot(X_plot_long, aes(y = Y, x=day,
shape = "variable",
color = site_type,
group = interaction(site, ft)))+
geom_point() + geom_line() + facet_grid(site_type~.)
head(X_plot_long)
ggplot(X_plot_long, aes(y = Y, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
ggplot(X_plot_long, aes(y = Y, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line()
dim(X_plot_long)
dim(X_plot)
names(X_plot)
names(X_plot_long)
ggplot(X_plot_long, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line()
ggplot(X_plot_long, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
mean(fit.y)
mean(fit.Y)
mean(X_plot$fit.Y)
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y_no" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values,
"fit.Y" = lm.fit(x=as.matrix(X), y=Y)$fitted.values))
X_plot = data.frame(cbind("site" = rep(c(1,2,3),60), "ft" = rep(c(2,2,2,3,3,3),30),
"y_pre_day" = y_pre_day, "day" = c(rep(1:30, each = 6)),
"Y" = y, "fit.Y_no" = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$fitted.values,
"fit.Y" = lm.fit(x=as.matrix(X), y=Y)$fitted.values))
X_plot$site_type = paste(X_plot$site, "_", X_plot$ft)
X_plot_long_1 = melt(X_plot, id.vars=c(1:4,7))
ggplot(X_plot_long_1, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
names(X_plot)
X_plot_long_no = melt(X_plot, id.vars=c(1:4,7,8))
ggplot(X_plot_long_no, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
X_plot_long = melt(X_plot, id.vars=c(1:4,6,8))
ggplot(X_plot_long, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
names(X_plot_long)
X_plot_long = melt(X_plot, id.vars=c(1:4,6,8))
ggplot(X_plot_long, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
ggplot(X_plot_long_no, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
head(X_plot)
head(X_plot_long)
ggplot(X_plot_long, aes(y = value, x=day,
linetype = variable,
color = site_type,
group = interaction(site_type, variable)))+
geom_point() + geom_line() + facet_grid(site_type~.)
180*60
369=0*180
360*180
day = rep(c(rep(1:30, each = 6)),12)
length(day)
18*12
month = c(rep(1:12, each = 180))
length(month)
y_pre_day = rpois(180, 10)
ft = rep(c(rep(c(0,0,0,1,1,1),30)),12)
length(ft)
beta.true = round(rnorm(7, mean =10, sigma = 21))
beta.true = round(rnorm(7, mean =10, sigma = 20))
beta.true = round(rnorm(7, 10, 20))
beta.true
sigma.star = 10
length(rep(rep(c(1,2,3),60),12))
rep(rep(c(2,2,2,3,3,3),30),12)
length(rep(rep(c(2,2,2,3,3,3),30),12))
d = data.frame(cbind(
"site" = rep(rep(c(1,2,3),60),12),
"ft" = rep(rep(c(2,2,2,3,3,3),30),12),
"month" = month,
"date" = date,
"y_pre_day" = y_pre_day
))
site_1 = rep(c(rep(c(0,0,1),60)),12)
site_2 = rep(c(rep(c(0,1,0),60)),12)
ft = rep(c(rep(c(0,0,0,1,1,1),30)),12)
y_pre_day = rpois(2160, 10) #2160
month = c(rep(1:12, each = 180)) # 2160
date = rep(c(rep(1:30, each = 6)),12) # 2160
X = data.frame(cbind(site_1,site_2,ft, month, date, y_pre_day))
d = data.frame(cbind(
"site" = rep(rep(c(1,2,3),60),12),
"ft" = rep(rep(c(2,2,2,3,3,3),30),12),
"month" = month,
"date" = date,
"y_pre_day" = y_pre_day
))
site_1 = rep(c(rep(c(0,0,1),60)),12)
site_2 = rep(c(rep(c(0,1,0),60)),12)
ft = rep(c(rep(c(0,0,0,1,1,1),30)),12)
y_pre_day = rpois(2160, 10) #2160
month = c(rep(1:12, each = 180)) # 2160
date = rep(c(rep(1:30, each = 6)),12) # 2160
X = data.frame(cbind(site_1,site_2,ft, month, date, y_pre_day))
d = data.frame(cbind(
"site" = rep(rep(c(1,2,3),60),12),
"ft" = rep(rep(c(2,2,2,3,3,3),30),12),
"month" = month,
"date" = date,
"y_pre_day" = y_pre_day
))
beta.true = round(rnorm(7, 10, 20))
sigma.star = 10
X = cbind(1, X)
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(2160)
d$actual.y = cbind(d,y)
d$actual.y = cbind(d,Y)
names(d)
m1 = lm(Y~.,X)
m1$coefficients
beta.ture
beta.true
d$fitted.y = lm.fit(x=as.matrix(X), y=Y)$fitted.value
names(d)
names(x)
names(X)
names(d)
d$fitted.y_no = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
namejs(d)
names(d)
d$site_type = paste(d$site, "_", d$ft)
names(d)
d_long_no = melt(d, id.vars=c(-6,-8))
d_long_no = melt(d, id.vars=c(1:5,7,9))
d$site_type = paste(d$site, "_", d$ft)
d_long_no = melt(d, id.vars=c(1:5,7,9))
site_1 = rep(c(rep(c(0,0,1),60)),12)
site_2 = rep(c(rep(c(0,1,0),60)),12)
ft = rep(c(rep(c(0,0,0,1,1,1),30)),12)
y_pre_day = rpois(2160, 10) #2160
month = c(rep(1:12, each = 180)) # 2160
date = rep(c(rep(1:30, each = 6)),12) # 2160
X = data.frame(cbind(site_1,site_2,ft, month, date, y_pre_day))
d = data.frame(cbind(
"site" = rep(rep(c(1,2,3),60),12),
"ft" = rep(rep(c(2,2,2,3,3,3),30),12),
"month" = month,
"date" = date,
"y_pre_day" = y_pre_day
))
beta.true = round(rnorm(7, 10, 20))
sigma.star = 10
X = cbind(1, X)
Y = as.matrix(X) %*% beta.true + sigma.star*rnorm(2160)
d$actual.y = cbind(d,Y)
# fitted model
m1 = lm(Y~.,X)
m1$coefficients
lm.fit(x=as.matrix(X), y=Y)$coefficient
d$fitted.y = lm.fit(x=as.matrix(X), y=Y)$fitted.value
m1_no = lm(Y~.-y_pre_day, X)
m1_no$coefficients
d$fitted.y_no = lm.fit(x=as.matrix(X)[,c(1:4)], y=Y)$coefficient
y = as.vector(Y)
library(ggplot2)
library(reshape2)
d$site_type = paste(d$site, "_", d$ft)
dim(d)
d_long_no = melt(d, id.vars=c(1:5,7,9))
str(d)
d$actual.y = Y
str(d)
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
arima.sim(n = 10, list(ar = c(0.8897, -0.4858), ma = c(-0.2279, 0.2488)),
sd = sqrt(0.1796))
?arima
library(forecast)
auto.arima(y)
arima(y, c(2,0,2))
ts.sim <- arima.sim(list(order = c(1,1,0), ar = 0.7), n = 200)
ts.plot(ts.sim)
auto.arima(ts.sim)
ts.sim <- arima.sim(n = 200)
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
2017-65
2017-40
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
if(!require("devtools")) install.packages("devtools")
if(!require("servr")) install.packages("servr")
if(!require("knitr")) install.packages("knitr")
library(servr)
#devtools::install_github("choux130/servr_2")
library(devtools)
#ls("package:servr")
#jekyll
#build_jekyll
#trace("jekyll",edit=TRUE)
#dev_mode()
servr::jekyll(dir = ".", input = c(".", "_source", "_posts"),
output = c(".", "_posts", "_posts"),
script = c("Makefile", "build.R"),
serve = TRUE,
command = "bundle exec jekyll build")
